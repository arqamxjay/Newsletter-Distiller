{% extends "base.html" %}

{% block title %}Settings - Newsletter Distiller{% endblock %}

{% block extra_css %}
<style>
    .settings-container {
        max-width: 600px;
    }
    
    .settings-section {
        background: white;
        border-radius: 16px;
        padding: 2rem;
        margin-bottom: 2rem;
        box-shadow: var(--shadow);
        border: 1px solid var(--border);
    }
    
    .settings-section h2 {
        margin-bottom: 1.5rem;
        color: var(--secondary);
        padding-bottom: 1rem;
        border-bottom: 2px solid #e2e8f0;
    }
    
    .gmail-status {
        background: #ecfdf3;
        border: 1px solid #bbf7d0;
        border-radius: 4px;
        padding: 1rem;
        margin-bottom: 1rem;
        color: #065f46;
    }
    
    .gmail-status.disconnected {
        background: #fef2f2;
        border-color: #fecaca;
        color: #991b1b;
    }
</style>
{% endblock %}

{% block content %}
<div class="settings-container">
    <div class="page-title" style="margin-bottom: 0.25rem;">Settings</div>
    <p class="page-subtitle" style="margin-bottom: 2rem;">Manage your Gmail connection and processing preferences.</p>
    
    <!-- Gmail Connection -->
    <div class="settings-section">
        <h2>Gmail Account</h2>
        
        {% if current_user.gmail_token %}
        <div class="gmail-status">
            ✓ Gmail account connected
        </div>
        
        <form method="POST" action="{{ url_for('gmail.disconnect') }}">
            <button type="submit" class="btn btn-secondary" style="width: 100%;">Disconnect Gmail</button>
        </form>
        {% else %}
        <div class="gmail-status disconnected">
            ✗ Gmail account not connected
        </div>
        
        <p class="muted" style="margin-bottom: 1rem;">
            Connect your Gmail account to access your emails and newsletters.
        </p>
        
        <a href="{{ url_for('gmail.authorize') }}" style="display: inline-block;">
            <button class="btn btn-primary">Connect Gmail Account</button>
        </a>
        {% endif %}
    </div>
    
    <!-- Processing Preferences -->
    <div class="settings-section">
        <h2>Processing Preferences</h2>
        
        <form method="POST">
            <div class="form-group">
                <label for="newsletter_label">Gmail Label</label>
                <input type="text" id="newsletter_label" name="newsletter_label" 
                       value="{{ prefs.newsletter_label or 'To-Summarize' }}"
                       placeholder="e.g., To-Summarize">
                <small class="muted" style="display: block; margin-top: 0.25rem;">
                    The Gmail label to look for newsletters
                </small>
            </div>
            
            <div class="form-group">
                <label for="summary_style">Summary Style</label>
                <select id="summary_style" name="summary_style">
                    <option value="bullet-points" {% if prefs.summary_style == 'bullet-points' %}selected{% endif %}>Bullet Points</option>
                    <option value="paragraph" {% if prefs.summary_style == 'paragraph' %}selected{% endif %}>Paragraph</option>
                    <option value="summary" {% if prefs.summary_style == 'summary' %}selected{% endif %}>Executive Summary</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="send_to_email">Send Processed Emails To</label>
                <input type="email" id="send_to_email" name="send_to_email" 
                       value="{{ prefs.send_to_email or current_user.email }}"
                       placeholder="your-email@example.com">
            </div>
            
            <div class="form-group">
                <label>
                    <input type="checkbox" name="auto_send" 
                           {% if prefs.auto_send %}checked{% endif %}>
                    Auto-send processed newsletters
                </label>
            </div>
            
            <button type="submit" class="btn btn-primary" style="width: 100%;">Save Preferences</button>
        </form>
    </div>
</div>
{% endblock %}
